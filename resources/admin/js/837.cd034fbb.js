"use strict";(self["webpackChunkhalo_admin"]=self["webpackChunkhalo_admin"]||[]).push([[837],{38837:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var s=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:0}},[t("a-col",{staticClass:"h-screen",staticStyle:{"border-right":"1px solid #f2f2f2"},attrs:{md:5,sm:24}},[t("a-spin",{staticClass:"h-full",attrs:{spinning:e.theme.loading}},[t("ThemeSettingForm",{attrs:{theme:e.theme.data,wrapperCol:{span:24}},on:{saved:e.onSettingsSaved},scopedSlots:e._u([{key:"descriptions-item",fn:function(){return[t("a-descriptions-item",[t("a-button",{on:{click:function(t){return e.handleRouteToThemeSetting()}}},[e._v("返回")])],1)]},proxy:!0}])})],1)],1),t("a-col",{staticClass:"h-screen",attrs:{md:19,sm:24}},[t("iframe",{attrs:{id:"themeViewIframe",src:e.options.blog_url,frameborder:"0",height:"100%",scrolling:"auto",width:"100%"}})])],1)},n=[],i=(a(70560),a(77838)),r=a(80068),o=a(20629),l={name:"ThemeVisualSetting",components:{ThemeSettingForm:i.Z},data(){return{theme:{data:{},loading:!1}}},computed:{...(0,o.Se)(["options"])},beforeRouteEnter(e,t,a){const s=e.query.themeId;a((async e=>{await e.handleGetTheme(s)}))},methods:{async handleGetTheme(e){try{this.theme.loading=!0;const{data:t}=await r.Z.theme.get(e);this.theme.data=t}finally{this.theme.loading=!1}},handleRouteToThemeSetting(){this.$router.push({name:"ThemeSetting",query:{themeId:this.theme.id}})},onSettingsSaved(){document.getElementById("themeViewIframe").contentWindow.location.reload()}}},m=l,c=a(1001),d=(0,c.Z)(m,s,n,!1,null,"19de66d0",null),h=d.exports},77838:function(e,t,a){a.d(t,{Z:function(){return d}});var s=function(){var e=this,t=e._self._c;return e.theme.id?t("div",{staticClass:"card-container h-full"},[t("a-tabs",{staticClass:"h-full",attrs:{defaultActiveKey:"0",type:"card"}},[t("a-tab-pane",{key:0,attrs:{tab:"关于"}},[e.theme.logo?t("div",[t("a-avatar",{attrs:{alt:e.theme.name,size:72,src:e.theme.logo,shape:"square"}}),t("a-divider")],1):e._e(),t("a-descriptions",{attrs:{column:1,layout:"horizontal"}},[t("a-descriptions-item",{attrs:{label:"作者"}},[t("a",{staticClass:"text-inherit",attrs:{href:e.theme.author.website||"#",target:"_blank"}},[e._v(" "+e._s(e.theme.author.name)+" ")])]),t("a-descriptions-item",{attrs:{label:"介绍"}},[e._v(" "+e._s(e.theme.description||"-")+" ")]),t("a-descriptions-item",{attrs:{label:"官网"}},[t("a",{staticClass:"text-inherit",attrs:{href:e.theme.website||"#",target:"_blank"}},[e._v(" "+e._s(e.theme.website||"-")+" ")])]),t("a-descriptions-item",{attrs:{label:"Git 仓库"}},[t("a",{staticClass:"text-inherit",attrs:{href:e.theme.repo||"#",target:"_blank"}},[e._v(" "+e._s(e.theme.repo||"-")+" ")])]),t("a-descriptions-item",{attrs:{label:"主题标识"}},[e._v(" "+e._s(e.theme.id)+" ")]),t("a-descriptions-item",{attrs:{label:"当前版本"}},[e._v(" "+e._s(e.theme.version)+" ")]),t("a-descriptions-item",{attrs:{label:"存储位置"}},[e._v(" "+e._s(e.theme.themePath)+" ")]),e._t("descriptions-item")],2)],1),e._l(e.form.configurations,(function(a,s){return t("a-tab-pane",{key:s+1,attrs:{tab:a.label}},[t("a-form",{attrs:{wrapperCol:e.wrapperCol,layout:"vertical"}},[e._l(a.items,(function(a,s){return t("a-form-item",{key:s,attrs:{label:a.label+"："}},[a.description&&""!==a.description?t("p",{attrs:{slot:"help"},domProps:{innerHTML:e._s(a.description)},slot:"help"}):e._e(),"TEXT"===a.type?t("a-input",{attrs:{defaultValue:a.defaultValue,placeholder:a.placeholder},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):"TEXTAREA"===a.type?t("a-input",{attrs:{autoSize:{minRows:5},placeholder:a.placeholder,type:"textarea"},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):"RADIO"===a.type?t("a-radio-group",{attrs:{defaultValue:a.defaultValue},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}},e._l(a.options,(function(a,s){return t("a-radio",{key:s,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1):"SELECT"===a.type?t("a-select",{attrs:{defaultValue:a.defaultValue},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}},e._l(a.options,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1):"COLOR"===a.type?t("verte",{staticStyle:{display:"inline-block",height:"24px"},attrs:{defaultValue:a.defaultValue,model:"hex",picker:"square"},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):"ATTACHMENT"===a.type?t("AttachmentInput",{attrs:{defaultValue:a.defaultValue,placeholder:a.placeholder},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):"NUMBER"===a.type?t("a-input-number",{staticStyle:{width:"100%"},attrs:{defaultValue:a.defaultValue},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):"SWITCH"===a.type?t("a-switch",{attrs:{defaultChecked:a.defaultValue},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}}):t("a-input",{attrs:{defaultValue:a.defaultValue,placeholder:a.placeholder},model:{value:e.form.settings[a.name],callback:function(t){e.$set(e.form.settings,a.name,t)},expression:"form.settings[item.name]"}})],1)})),t("a-form-item",[t("ReactiveButton",{attrs:{errored:e.form.saveErrored,loading:e.form.saving,erroredText:"保存失败",loadedText:"保存成功",text:"保存",type:"primary"},on:{callback:e.handleSaveSettingsCallback,click:e.handleSaveSettings}})],1)],2)],1)}))],2)],1):e._e()},n=[],i=a(94927),r=a(80068),o={name:"ThemeSettingForm",components:{Verte:i.Z},props:{theme:{type:Object,default:()=>{}},wrapperCol:{type:Object,default:()=>({xl:{span:8},lg:{span:8},sm:{span:12},xs:{span:24}})}},data(){return{form:{settings:[],configurations:[],loading:!1,saving:!1,saveErrored:!1}}},watch:{theme(e){e&&this.handleGetConfigurations()}},methods:{async handleGetConfigurations(){try{const{data:e}=await r.Z.theme.listConfigurations(this.theme.id);this.form.configurations=e,await this.handleGetSettings()}catch(e){this.$log.error(e)}},async handleGetSettings(){try{const{data:e}=await r.Z.theme.listSettings(this.theme.id);this.form.settings=e}catch(e){this.$log.error(e)}},async handleSaveSettings(e=!0){try{e&&(this.form.saving=!0),await r.Z.theme.saveSettings(this.theme.id,this.form.settings)}catch(t){throw this.$log.error(t),this.form.saveErrored=!0,new Error(t)}finally{setTimeout((()=>{this.form.saving=!1}),400)}},handleSaveSettingsCallback(){this.form.saveErrored?this.form.saveErrored=!1:(this.handleGetSettings(),this.$emit("saved"))}}},l=o,m=a(1001),c=(0,m.Z)(l,s,n,!1,null,null,null),d=c.exports}}]);